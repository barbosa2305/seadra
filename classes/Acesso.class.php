<?php
/**
 * System generated by SysGen (System Generator with Formdin Framework) 
 * Download SysGen: https://github.com/bjverde/sysgen
 * Download Formdin Framework: https://github.com/bjverde/formDin
 * 
 * SysGen  Version: 0.9.0
 * FormDin Version: 4.2.6-alpha
 * 
 * System ap2v created in: 2018-11-21 23:30:54
 */

class Acesso {

    const USER_ADMIN = 'admin';
    const USER_GRUPO_ADMIN = 'A';

	public function __construct(){
    }    

	//--------------------------------------------------------------------------------	
	public static function login( $login_user, $pwd_user ){
        $result = 0;
        $user = UsuarioDAO::selectByLoginAtivo( $login_user );
        if ( !empty($user) ) {
            if (password_verify($pwd_user, $user['DSSENHA'][0])) {
                $_SESSION[APLICATIVO]['USER']['IDUSUARIO'] = $user['IDUSUARIO'][0];
                $_SESSION[APLICATIVO]['USER']['LOGIN']  = $login_user;
                $_SESSION[APLICATIVO]['USER']['NOME']  = $user['NMUSUARIO'][0];
                $_SESSION[APLICATIVO]['USER']['GRUPO']  = $user['TPGRUPO'][0];
                $result = 1;
            } 
        }
        return $result;
    }

    public static function getUserId(){
        $userId = null;
        if ( ArrayHelper::has(APLICATIVO, $_SESSION) ){
            $user = ArrayHelper::get( $_SESSION[APLICATIVO],'USER' );
            $userId = $user['IDUSUARIO']; 
        }
        return $userId;
    }
    
    public static function getUserLogin(){
        $userLogin = null;
        if (ArrayHelper::has( APLICATIVO, $_SESSION) ){
            $user = ArrayHelper::get( $_SESSION[APLICATIVO],'USER' );
            $userLogin = $user['LOGIN'];
        }
        return $userLogin;
    }

    public static function getUserName(){
        $userName = null;
        if (ArrayHelper::has( APLICATIVO, $_SESSION) ){
            $user = ArrayHelper::get( $_SESSION[APLICATIVO],'USER' );
            $userName = $user['NOME'];
        }
        return $userName;
    }

    public static function getUserGroup(){
        $userGroup = null;
        if (ArrayHelper::has( APLICATIVO, $_SESSION) ){
            $user = ArrayHelper::get( $_SESSION[APLICATIVO],'USER' );
            $userGroup = $user['GRUPO'];
        }
        return $userGroup;
    }

	public static function isUserLoggedAdm(){
        $result = false;     
        if ( self::getUserLogin() == self::USER_ADMIN ) {
            $result = true;
        }
        return $result;
    }
}
?>